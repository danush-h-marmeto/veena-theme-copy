{{ 'product-card.css' | asset_url | stylesheet_tag }}
{% liquid
  assign current_variant = product.selected_or_first_available_variant 
  assign featured_image = current_variant.image | default: product.featured_image
  assign secondary_image = product.images[1] | default: product.featured_image
  assign discountPercentage = current_variant.compare_at_price | minus: current_variant.price | times: 100 | divided_by: current_variant.compare_at_price
%}

<product-card class="product-card" data-product-handle="{{ product.handle }}" data-section-id="{{ section.id }}">
  <div class="productcard-image__wrapper image-hover-swap">
    <a href="{{ product.url }}">
      {% render 'responsive-picture',
        class: 'media media--portrait custom-border-radius-sm  media--transparent  image-featured-hidden' ,
        desktopImage: featured_image
      %}
      {% render 'responsive-picture',
        class: 'media media--portrait custom-border-radius-sm  media--transparent  image-secondary-hidden',
        desktopImage: secondary_image
      %}
    </a>
  </div>
  <div class="product-card__left-tags">
    {% for tag in product.tags %}
      {% if tag contains "New" %}
        {% assign badge_text = tag | split: '_' | first %}
      {% endif %}  
    {% endfor %} 
    {% if badge_text != blank %}
      <span class="h5 product-card__badge">
        {{ badge_text }}
      </span>
    {% endif %}
   {% if discountPercentage >= 20 %}
    <span class="h5 product-card__discount">
      {{ discountPercentage }}% off
    </span>
   {% endif %}
  </div>
  <div class="product-card__info">
     {% for variant in product.variants %}
      <div class="product-card__quick-view">
        <a href="{{ variant.url }}" class="custom-button-secondary_color product-card__quick-view-button"> Quick Look</a>    
      </div>
     {% endfor %}
   <div class="product-card__radiobtn">
  {% for varient_option in product.options_with_values %}
    {% if varient_option.name == "Color" %}
      {% for option in varient_option.values %}
        <div class="item-swatch">
          <div class="product-card__dots">
          <input type="radio" value="{{ option }}" class="required" {% if varient_option.selected_value == option %}checked{% endif %} name="option-{{ current_variant.id }}">
            <div data-value="{{ option |  handleize }}" class="swatch-circle" for="option-{{ current_variant.id }}">
            </div>
            </div>
        </div>
      {% endfor %}
    {% endif %}
  {% endfor %}
</div>

<span class="h4">{{ product.vendor }}</span>
    <a href="{{ product.url }}" class="product-card__title h3 full-unstyled-link">{{ product.title }}</a>

    
            {%- if product.metafields.reviews.rating.value != blank -%}
              {% liquid
                assign rating_decimal = 0
                assign decimal = product.metafields.reviews.rating.value.rating | modulo: 1
                if decimal >= 0.3 and decimal <= 0.7
                  assign rating_decimal = 0.5
                elsif decimal > 0.7
                  assign rating_decimal = 1
                endif
              %}
              <div
                class="rating"
                role="img"
                aria-label="{{ 'accessibility.star_reviews_info' | t: rating_value: product.metafields.reviews.rating.value, rating_max: card_product.metafields.reviews.rating.value.scale_max }}"
              >
                <span
                  aria-hidden="true"
                  class="rating-star"
                  style="--rating: {{ product.metafields.reviews.rating.value.rating | floor }}; --rating-max: {{ product.metafields.reviews.rating.value.scale_max }}; --rating-decimal: {{ rating_decimal }};"
                ></span>
              </div>
              <p class="rating-text caption">
                <span aria-hidden="true">
                  {{- product.metafields.reviews.rating.value }} /
                  {{ product.metafields.reviews.rating.value.scale_max -}}
                </span>
              </p>
              <p class="rating-count caption">
                <span aria-hidden="true">({{ product.metafields.reviews.rating_count }})</span>
                <span class="visually-hidden">
                  {{- product.metafields.reviews.rating_count }}
                  {{ 'accessibility.total_reviews' | t -}}
                </span>
              </p>
            {%- endif -%}
    {% if product.price_varies %}
      <span class="h3 bold">From {{ product.price_min | money_with_currency }}</span>
    {% else %}
      <span class="h3 bold">{{ current_variant.price | money_with_currency }}</span>   
    {% endif %}  
    
    {% if product.compare_at_price > current_variant.price %}
      <s class="h3 compare_price">{{ current_variant.compare_at_price | money_with_currency }}</s>
    {% endif %}
{% if current_variant.inventory_quantity > 10 %}
  <span class="product-card__max-stock">{{ current_variant.inventory_quantity }} in stock</span>
{% elsif current_variant.inventory_quantity > 0 %}
  <span class="product-card__min-stock">Only {{ current_variant.inventory_quantity }} units left</span>
{% else %}
  <span class="product-card__min-stock">Out of Stock</span>
{% endif %}

     
  </div>

  <script>
    {{ product.variants | json }}
  </script>
</product-card>
